<!doctype html>
<html lang="zh-Hant">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>二營健康管理中心</title>
  <style>
    body {
      font-family: Arial, "Noto Sans TC", sans-serif;
      margin:0; padding:0;
      background: linear-gradient(135deg, rgba(255,255,255,0.6), rgba(200,200,255,0.4));
      backdrop-filter: blur(8px);
      -webkit-backdrop-filter: blur(8px);
      color:#222;
    }
    header {
      background: rgba(0,77,153,0.6);
      color:#fff; padding:1rem; text-align:center;
      border-bottom:1px solid rgba(255,255,255,0.3);
      backdrop-filter: blur(10px);
    }
    h1 { margin:0; }
    #marquee {
      overflow:hidden; white-space:nowrap; box-sizing:border-box;
      animation: marquee 30s linear infinite;
      font-weight:bold; margin-top:0.5rem;
    }
    @keyframes marquee {
      0% { transform:translateX(100%); }
      100% { transform:translateX(-100%); }
    }
    main { text-align:center; padding:2rem; }
    button {
      display:block;
      width:260px;
      margin:1rem auto; padding:1rem; font-size:1rem;
      border:none; border-radius:12px; cursor:pointer;
      backdrop-filter: blur(6px);
    }
    button.primary { background:rgba(0,123,255,0.7); color:#fff; }
    button.secondary { background:rgba(40,167,69,0.7); color:#fff; }
    footer {
      text-align:center; padding:1rem; margin-top:2rem;
      background:rgba(255,255,255,0.3);
      border-top:1px solid rgba(255,255,255,0.4);
      backdrop-filter: blur(6px);
    }
    .modal { display:none; position:fixed; z-index:100; left:0; top:0;
      width:100%; height:100%; overflow:auto;
      background:rgba(0,0,0,0.6); }
    .modal-content {
      background:rgba(255,255,255,0.95);
      backdrop-filter: blur(15px);
      margin:5% auto; padding:20px;
      border-radius:12px; width:90%; max-width:500px;
    }
    .close { color:#333; float:right; font-size:28px; font-weight:bold; cursor:pointer; }
    .close:hover { color:#000; }
    form input, form textarea {
      width:95%; padding:8px; margin:6px 0; border-radius:6px; border:1px solid #ccc;
    }
    form button { width:100%; margin-top:10px; }
  </style>
</head>
<body>
<header>
  <h1>二營健康管理中心</h1>
  <div id="marquee">健康標語載入中...</div>
</header>
<main>
  <button class="primary" onclick="window.open('https://forms.gle/cr3efubbA1WoArfp6','_blank')">BMI 回報</button>
  <button id="reportBtn" class="secondary">回診狀況回報</button>
  <button id="menuBtn" class="secondary">今日減脂菜單</button>
</main>

<!-- 減脂菜單 Modal -->
<div id="menuModal" class="modal">
  <div class="modal-content">
    <span id="closeMenu" class="close">&times;</span>
    <h2>今日減脂菜單</h2>
    <ul id="menuList"></ul>
    <p id="calories"></p>
  </div>
</div>

<!-- 回診狀況回報 Modal -->
<div id="reportModal" class="modal">
  <div class="modal-content">
    <span id="closeReport" class="close">&times;</span>
    <h2>回診狀況回報</h2>
    <form id="reportForm">
      <input type="text" name="name" placeholder="姓名" required><br>
      <input type="text" name="unit" placeholder="單位" required><br>
      <input type="date" name="date" required><br>
      <input type="text" name="hospital" placeholder="回診醫院" required><br>
      <input type="text" name="doctor" placeholder="醫師姓名" required><br>
      <textarea name="note" placeholder="回診狀況描述"></textarea><br>
      <button type="submit">送出</button>
    </form>
    <p id="reportMsg"></p>
  </div>
</div>

<footer>
  <p>&copy; 2025 二營健康管理中心</p>
</footer>
<script>
// 健康標語池
const slogans = [
  "均衡飲食，體能常青",
  "多喝水，少喝含糖飲料",
  "睡眠充足，精神百倍",
  "規律運動，強健體魄",
  "拒菸酒檳榔，健康一生",
  "三餐定時定量，少吃宵夜",
  "控制體重，守護戰力",
  "壓力釋放，心理健康",
  "每週至少運動150分鐘",
  "少油少鹽少糖，多蔬果高纖維"
];
document.getElementById('marquee').textContent = slogans[Math.floor(Math.random()*slogans.length)];

// 每日菜單 (含熱量)
const menus = [
  [
    {meal:"早餐：燕麥＋水煮蛋＋無糖豆漿", kcal:350},
    {meal:"午餐：雞胸肉＋糙米＋燙青菜", kcal:500},
    {meal:"晚餐：蔬菜湯＋豆腐＋水果", kcal:300}
  ],
  [
    {meal:"早餐：全麥吐司＋低脂牛奶", kcal:300},
    {meal:"午餐：鮭魚＋糙米＋青花菜", kcal:550},
    {meal:"晚餐：蒸蛋＋炒菠菜＋水果", kcal:320}
  ],
  [
    {meal:"早餐：無糖優格＋堅果＋水果", kcal:280},
    {meal:"午餐：雞腿排＋糙米＋時蔬", kcal:520},
    {meal:"晚餐：豆漿＋沙拉", kcal:250}
  ],
  [
    {meal:"早餐：水煮蛋＋燕麥粥", kcal:330},
    {meal:"午餐：牛肉片＋地瓜＋青菜", kcal:560},
    {meal:"晚餐：味噌湯＋豆腐＋水果", kcal:310}
  ],
  [
    {meal:"早餐：全麥饅頭＋豆漿", kcal:340},
    {meal:"午餐：雞胸肉＋糙米＋燙青菜", kcal:500},
    {meal:"晚餐：蔬菜湯＋雞蛋＋水果", kcal:280}
  ],
  [
    {meal:"早餐：水煮蛋＋黑咖啡＋水果", kcal:260},
    {meal:"午餐：鮭魚＋地瓜＋青菜", kcal:540},
    {meal:"晚餐：豆漿＋炒青菜", kcal:270}
  ],
  [
    {meal:"早餐：燕麥片＋堅果＋牛奶", kcal:360},
    {meal:"午餐：雞胸肉＋糙米＋燙青菜", kcal:500},
    {meal:"晚餐：蔬菜湯＋豆腐＋水果", kcal:310}
  ]
];
const todayMenu = menus[new Date().getDay()];
document.getElementById("menuList").innerHTML = todayMenu.map(i => `<li>${i.meal} (${i.kcal} kcal)</li>`).join("");
document.getElementById("calories").textContent = "每日總熱量：約 " + todayMenu.reduce((a,b)=>a+b.kcal,0) + " kcal";

// Modal 控制
function setupModal(btnId, modalId, closeId) {
  const btn = document.getElementById(btnId);
  const modal = document.getElementById(modalId);
  const span = document.getElementById(closeId);
  btn.onclick = () => { modal.style.display = "block"; }
  span.onclick = () => { modal.style.display = "none"; }
  window.addEventListener("click", e => { if (e.target==modal) modal.style.display="none"; });
}
setupModal("menuBtn","menuModal","closeMenu");
setupModal("reportBtn","reportModal","closeReport");

// Report Form Submit (no file upload)
document.getElementById("reportForm").onsubmit = async (e) => {
  e.preventDefault();
  const msg = document.getElementById("reportMsg");
  msg.textContent = "上傳中...";

  const formData = new FormData(e.target);
  const data = {
    name: formData.get("name"),
    unit: formData.get("unit"),
    date: formData.get("date"),
    hospital: formData.get("hospital"),
    doctor: formData.get("doctor"),
    note: formData.get("note")
  };

  try {
    const response = await fetch("https://script.google.com/macros/s/AKfycbyOK8JPVH0-stzBpBg-iaPaD6RBLqLPzyZ0wJu0ZogUNzHv5gwI3bF0rgT5VLwkbwa1/exec", {
      method:"POST",
      body: JSON.stringify(data),
      headers: {"Content-Type":"application/json"}
    });
    const result = await response.json();
    msg.textContent = result.message;
  } catch(err) {
    msg.textContent = "上傳失敗：" + err;
  }
};
</script>
</body>
</html>
